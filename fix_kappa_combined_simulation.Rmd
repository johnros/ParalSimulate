---
title: "Parallelization Simulation"
author: "Jonathan Rosenblatt"
date: "1/1/2015"
output: pdf_document
---

```{r run simulation}
source('fix_kappa_run.R')
```

```{r split results}
# load(file='RData/MSEs_fix_kappa.1.RData') 

MSEs.framed.fix.kappa <- frameMSEs_fixKappa(MSEs.fix.kappa, configurations.fix.kappa)


ols.ind <- getModel(MSEs.framed.fix.kappa, my.ols)
ols.ind %>% table
ridge.ind <- getModel(MSEs.framed.fix.kappa, my.ridge)
nls.ind <- getModel(MSEs.framed.fix.kappa, my.log.link)
logistic.ind <- getModel(MSEs.framed.fix.kappa, my.logistic)

configurations.fix.kappa[ols.ind,'name'] <- 'ols'
configurations.fix.kappa[ridge.ind,'name'] <- 'ridge'
configurations.fix.kappa[nls.ind,'name'] <- 'non-linear'
configurations.fix.kappa[logistic.ind,'name'] <- 'logistic'


MSEs.framed.00 <- MSEs.framed.fix.kappa[ols.ind,]
MSEs.framed.10 <- MSEs.framed.fix.kappa[ridge.ind,]
MSEs.framed.30 <- MSEs.framed.fix.kappa[nls.ind,]
MSEs.framed.40 <- MSEs.framed.fix.kappa[logistic.ind,]
```


```{r all_plots}
.ylim <- c(0.5,1.5)
.ylim2 <- c(0.5,30)

.jitter <- 100
plot.00 <- plotMSEs_fixKappa(MSEs.framed.00, '(a) OLS', legend.position='none', y.lim=.ylim)
plot.10 <- plotMSEs_fixKappa(MSEs.framed.10, '(b) Ridge', legend.position='none', y.lim=.ylim)
plot.30 <- plotMSEs_fixKappa(MSEs.framed.30, '(c) Non-Linear Least Squares', legend.position='none', y.lim=.ylim2)
plot.40 <- plotMSEs_fixKappa(MSEs.framed.40, '(d) Logistic Regression', legend.position='right', y.lim=.ylim2)

grid.arrange(plot.00, plot.10, plot.30, plot.40, ncol=2)
```


```{r export plot}
directory <- "~/workspace/ParalSimulate/output/"
the.file <-paste(directory, "highdim_asymptotics_1.pdf", sep='')
pdf(file=the.file, onefile = FALSE, paper = "special", width=8, height=8)
grid.arrange(plot.00, plot.10, plot.30, plot.40, ncol=2)
dev.off()
```


```{r export data}
flat.fix.kappa <- lapply(MSEs.fix.kappa, t) %>% do.call(rbind,.)

selected.configurations.fix.kappa <- configurations.fix.kappa %>% select(name,n,p,m,N,kappa,sigma)

repeated.configurations.fix.kappa <- NULL
for(i in 1:nrow(configurations.fix.kappa) ){
  repeated.configurations.fix.kappa <- rbind(
    repeated.configurations.fix.kappa, 
    rep.row(selected.configurations.fix.kappa[i,], 
            configurations.fix.kappa$replications[i]))
}
MSEs.boaz.fix.kappa <- cbind(repeated.configurations.fix.kappa, flat.fix.kappa) 
head(MSEs.boaz.fix.kappa)

write.csv(MSEs.boaz.fix.kappa %>% as.matrix, file='output/fix_kappa_raw.csv',col.names=TRUE)
```

