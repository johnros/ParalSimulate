---
title: "Parallelization Simulation"
author: "Jonathan Rosenblatt"
date: "1/1/2015"
output: pdf_document
---

```{r run simulation}
# source('fix_p_run.R')
```

```{r split results}
# load(file='RData/MSEs_fix_p.5.RData') 

MSEs %>% length
MSEs.framed <- frameMSEs(MSEs, configurations)

MSEs.framed.0 <- MSEs.framed %>% filter(name=='ols')
MSEs.framed.1 <- MSEs.framed %>% filter(name=='ridge')
MSEs.framed.3 <- MSEs.framed %>% filter(name=='nls')
MSEs.framed.4 <- MSEs.framed %>% filter(name=='logistic')
```


```{r all_plots}
.ylim <- c(0.5,1.5)
.ylim2 <- c(0.5,20)
.jitter <- 10

plot.0 <- plotMSEs(MSEs.framed.0, '(a) OLS', center='median', legend.position='none', y.lim=.ylim, jitter=.jitter)

plot.1 <- plotMSEs(MSEs.framed.1, '(b) Ridge', center='median', legend.position='none', y.lim=.ylim, jitter=.jitter)

plot.3 <- plotMSEs(MSEs.framed.3, '(c) Non-Linear Least Squares', center='median', legend.position='none', jitter=.jitter, y.lim=.ylim2)

plot.4 <- plotMSEs(MSEs.framed.4, '(d) Logistic Regression', center='median', legend.position='right', jitter=.jitter, y.lim=.ylim2)

grid.arrange(plot.0, plot.1, plot.3, plot.4, ncol=2)
```


```{r export plot}
directory <- "~/workspace/ParalSimulate/output/"
the.file <-paste(directory, "classic_asymptotics_1.pdf", sep='')
pdf(file=the.file, onefile = FALSE, paper = "special", width=8, height=8)
grid.arrange(plot.0, plot.1, plot.3, plot.4, ncol=2)
dev.off()
```

```{r export data}
flat <- lapply(MSEs, t) %>% do.call(rbind,.)

selected.configurations <- configurations %>% select(name,n,p,m,N,sigma)

repeated.configurations <- NULL
for(i in 1:nrow(configurations) ){
  repeated.configurations <- rbind(
    repeated.configurations, 
    rep.row(selected.configurations[i,], configurations$replications[i]))
}
MSEs.boaz <- cbind(repeated.configurations, flat) 
head(MSEs.boaz)

write.csv(MSEs.boaz %>% as.matrix, file='output/fix_p_raw.csv',col.names=TRUE)
```

